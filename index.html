<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AVA Warsztat ‚Äî Profesjonalny serwis samochodowy</title>
<meta name="description" content="AVA Warsztat ‚Äî kompleksowy serwis, diagnostyka komputerowa, mechanika, klimatyzacja, wulkanizacja. Profesjonalnie, uczciwie, na czas." />
<meta property="og:title" content="AVA Warsztat ‚Äî Profesjonalny serwis samochodowy" />
<meta property="og:description" content="AVA Warsztat ‚Äî kompleksowy serwis, diagnostyka komputerowa, mechanika, klimatyzacja, wulkanizacja." />
<meta property="og:image" content="https://images.unsplash.com/photo-1503376780353-7e6692767b70?w=1200&q=80" />
<meta name="author" content="AVA Warsztat" />
<link rel="icon" href="favicon.png" />

<style>
  /* ---------- Root & resets ---------- */
  :root{
    --bg:#0f0f10;
    --panel:#151617;
    --muted:#aeb3b8;
    --accent:#28a745;
    --accent-2:#007bff;
    --glass: rgba(255,255,255,0.03);
    --radius:12px;
    --maxWidth:1200px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;line-height:1.45;-webkit-font-smoothing:antialiased}
  a{color:inherit}
  img{display:block;max-width:100%;height:auto}

  /* ---------- sticky navbar ---------- */
  header.site-header{
    position:fixed;inset:0 0 auto 0;height:72px;display:flex;align-items:center;justify-content:center;
    z-index:9999;backdrop-filter: blur(6px);background:linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.15));
    border-bottom:1px solid rgba(255,255,255,0.02);
  }
  .wrap { width:100%;max-width:var(--maxWidth);padding:0 20px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:12px;}
  .brand { display:flex;align-items:center;gap:12px;cursor:pointer; }
  .brand img{width:48px;height:48px;object-fit:cover;border-radius:8px}
  .brand h1{font-size:18px;margin:0;letter-spacing:0.3px}
  nav.top-nav{display:flex;gap:18px;align-items:center}
  nav.top-nav button{background:transparent;border:none;color:var(--muted);padding:8px 6px;font-weight:600;cursor:pointer;font-size:14px;transition:color .18s, transform .12s}
  nav.top-nav button:hover{color:var(--accent);transform:translateY(-2px)}
  nav.top-nav button.active{color:#fff;border-bottom:2px solid var(--accent);padding-bottom:6px}

  /* ---------- hero (slideshow) ---------- */
  .hero{
    height:calc(100vh - 72px); /* screen minus header */
    margin-top:72px;
    position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;text-align:left;
  }
  .hero .slides{position:absolute;inset:0}
  .hero .slide{position:absolute;inset:0;background-size:cover;background-position:center;opacity:0;transform:scale(1.03);transition:opacity 1s ease, transform 1.8s ease}
  .hero .slide.active{opacity:1;transform:scale(1)}
  .hero .overlay{position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.4), rgba(0,0,0,0.6));}
  .hero .content{position:relative;z-index:5;max-width:var(--maxWidth);padding:40px 24px}
  .eyebrow{color:var(--accent);font-weight:700;font-size:13px;margin-bottom:8px}
  .hero h2{font-size:44px;margin:0 0 12px;line-height:1.02}
  .hero p.lead{color:var(--muted);max-width:740px;margin:0 0 18px;font-size:16px}

  .hero .cta {display:flex;gap:12px;flex-wrap:wrap}
  .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 18px;border-radius:10px;background:var(--accent);color:#000;font-weight:700;border:none;cursor:pointer}
  .btn.secondary{background:transparent;color:#fff;border:2px solid rgba(255,255,255,0.06)}
  .btn.white{background:#fff;color:#000}

  /* ---------- main layout ---------- */
  main{max-width:var(--maxWidth);margin:60px auto;padding:0 20px 80px}
  .section{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:12px;padding:36px;margin-bottom:28px;box-shadow:0 8px 40px rgba(0,0,0,0.6)}
  .section h3{margin-top:0}
  .two-col{display:grid;grid-template-columns:1fr 380px;gap:24px;align-items:start}
  @media (max-width:900px){ .two-col{grid-template-columns:1fr} header.site-header{height:68px} .hero h2{font-size:30px} }

  /* ---------- about with animated cars background (parallax-like) ---------- */
  .about-wrap{position:relative;overflow:hidden;border-radius:12px}
  .about-bg{position:absolute;inset:0;background-repeat:repeat-x;background-size:cover;opacity:0.12;filter:grayscale(30%);transform:translateZ(0)}
  .about-bg.move{animation:moveBg 40s linear infinite}
  @keyframes moveBg{0%{background-position:0 0}100%{background-position:-1500px 0}}

  /* ---------- services list ---------- */
  .service{display:flex;gap:14px;align-items:flex-start;padding:14px;border-radius:10px;background:var(--glass);margin-bottom:12px}
  .service .icon{width:48px;height:48px;border-radius:8px;background:linear-gradient(135deg,var(--accent-2),var(--accent));display:flex;align-items:center;justify-content:center;font-weight:700}
  .service h4{margin:0 0 6px}

  /* ---------- gallery ---------- */
  .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
  .gallery img{width:100%;height:160px;object-fit:cover;border-radius:8px}

  /* ---------- opinie ---------- */
  .opinie-list{display:flex;flex-direction:column;gap:12px}
  .opinia{background:rgba(255,255,255,0.02);padding:14px;border-radius:10px}

  /* ---------- contact / form ---------- */
  form.contact{display:flex;flex-direction:column;gap:10px}
  input,select,textarea{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:10px;border-radius:8px;color:#fff}
  textarea{min-height:120px;resize:vertical}

  /* ---------- FAQ ---------- */
  details{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;margin-bottom:8px}
  details summary{cursor:pointer;font-weight:700}

  /* ---------- back icon & floating nav highlight ---------- */
  #backBtn{position:fixed;right:18px;bottom:18px;background:var(--accent);width:56px;height:56px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:none;font-size:22px;color:#000;z-index:999}
  .stickyPlaceholder{height:72px} /* so content isn't hidden under header */

  /* active nav highlight */
  nav.top-nav button.active{color:var(--accent);}

  /* small helpers */
  .muted{color:var(--muted)}
</style>
</head>
<body>

<!-- HEADER / NAV -->
<header class="site-header" role="banner">
  <div class="wrap">
    <div class="brand" id="homeBtn" title="Powr√≥t na start">
      <img src="AVA STR.jpeg" alt="AVA Warsztat logo (AVA STR.jpeg)">
      <div>
        <h1>AVA Warsztat</h1>
        <div class="muted" style="font-size:12px">Profesjonalny serwis samochodowy</div>
      </div>
    </div>

    <nav class="top-nav" role="navigation" aria-label="G≈Ç√≥wne menu">
      <button data-target="misja">Misja</button>
      <button data-target="dlaczego">Dlaczego AVA</button>
      <button data-target="uslugi">Us≈Çugi</button>
      <button data-target="onas">O nas</button>
      <button data-target="galeria">Galeria</button>
      <button data-target="opinie">Opinie</button>
      <button data-target="kontakt">Kontakt</button>
      <button data-target="faq">FAQ</button>
    </nav>
  </div>
</header>

<!-- HERO (slideshow) -->
<div class="slides" aria-hidden="true">
  <div class="slide active" style="background-image:url('https://images.unsplash.com/photo-1503376780353-7e6692767b70?w=1600&q=80')"></div>
  <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1493238792000-8113da705763?w=1600&q=80')"></div>
  <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1542367597-7fa4d3d6b2fc?w=1600&q=80')"></div>
  <!-- nowe sportowe auta -->
  <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1618335571254-3e2e5e70b1c7?w=1600&q=80')"></div> <!-- BMW -->
  <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1600180758895-0a2ffb9876ea?w=1600&q=80')"></div> <!-- Porsche -->
  <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1611764335916-0ad278f3c00d?w=1600&q=80')"></div> <!-- Audi R8 -->
</div>
  <div class="overlay" style="position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.5))"></div>

  <div class="content">
    <div class="eyebrow">AVA WARSZTAT</div>
    <h2>Profesjonalny serwis samochodowy ‚Äî diagnoza, naprawa, serwis</h2>
    <p class="lead">Kompleksowe przeglƒÖdy, naprawy mechaniczne, diagnostyka komputerowa i serwis klimatyzacji. Szybko, uczciwie, z gwarancjƒÖ na wykonane us≈Çugi.</p>

    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <a class="btn" href="tel:+48601749485">üìû Zadzwo≈Ñ</a>
      <a class="btn secondary" id="bookBtn">Um√≥w wizytƒô</a>
      <a class="btn white" href="#galeria">Zobacz galeriƒô</a>
    </div>
  </div>
</section>

<div class="stickyPlaceholder" aria-hidden="true"></div>

<!-- MAIN CONTENT -->
<main>

  <!-- MISJA -->
  <section id="misja" class="section" aria-labelledby="misjaTitle">
    <h3 id="misjaTitle">Nasza misja</h3>
    <div class="two-col">
      <div>
        <p class="muted">W AVA stawiamy na rzetelno≈õƒá, przejrzysto≈õƒá i jako≈õƒá. Ka≈ºde auto traktujemy tak, jak swoje w≈Çasne ‚Äî dlatego wykonujemy diagnostykƒô przed ka≈ºdƒÖ naprawƒÖ i dok≈Çadnie opisujemy zakres prac oraz koszty.</p>

        <h4 style="margin-top:18px">Co wyr√≥≈ºnia AVA?</h4>
        <ul>
          <li>‚úÖ Pe≈Çna diagnostyka komputerowa i testy drogowe</li>
          <li>‚úÖ Jasne koszty i kosztorys przed rozpoczƒôciem prac</li>
          <li>‚úÖ Czƒô≈õci wysokiej jako≈õci i gwarancja na us≈Çugƒô</li>
          <li>‚úÖ Szybkie terminy i raport z naprawy</li>
        </ul>
      </div>

      <aside class="card" style="background:var(--panel);padding:16px;border-radius:12px">
        <strong>Kontakt</strong>
        <p class="muted" style="margin:8px 0">Tel: <a href="tel:+48601749485">+48 601 749 485</a></p>
        <p class="muted">E-mail: <a href="mailto:ava.autosklep@gmail.com">ava.autosklep@gmail.com</a></p>
        <p class="muted">Godziny: Pn‚ÄìPt 8:00‚Äì16:00</p>
        <div style="margin-top:12px">
          <a class="btn white" href="https://maps.google.com?q=warsztat+AVA" target="_blank">üìç Dojazd</a>
        </div>
      </aside>
    </div>
  </section>

  <!-- DLACZEGO -->
  <section id="dlaczego" class="section" aria-labelledby="dlaczegoTitle">
    <h3 id="dlaczegoTitle">Dlaczego warto wybraƒá AVA?</h3>
    <p class="muted">Nie zostawiamy klienta z "czarnƒÖ skrzynkƒÖ" ‚Äî t≈Çumaczymy co naprawili≈õmy, jakie czƒô≈õci u≈ºyli≈õmy i jak zadbaƒá o auto dalej.</p>

    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin-top:18px">
      <div class="service"><div class="icon">01</div><div><h4>Diagnostyka</h4><div class="muted">Pe≈Çna diagnostyka komputerowa, testy uk≈Çad√≥w, pomiary i logi.</div></div></div>
      <div class="service"><div class="icon">02</div><div><h4>Mechanika</h4><div class="muted">Silniki, skrzynie, zawieszenia ‚Äî solidna naprawa i regulacje.</div></div></div>
      <div class="service"><div class="icon">03</div><div><h4>Klimatyzacja</h4><div class="muted">Serwis, nape≈Çnianie, odgrzybianie i testy szczelno≈õci.</div></div></div>
      <div class="service"><div class="icon">04</div><div><h4>Wulkanizacja</h4><div class="muted">Wymiana, prostowanie felg, przechowalnia k√≥≈Ç.</div></div></div>
    </div>
  </section>

  <!-- USLUGI (rozszerzone) -->
  <section id="uslugi" class="section" aria-labelledby="uslugiTitle">
    <h3 id="uslugiTitle">Nasze us≈Çugi ‚Äî szczeg√≥≈Çy i ceny orientacyjne</h3>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:18px">
      <div>
        <article style="margin-bottom:12px">
          <h4>Diagnostyka komputerowa</h4>
          <p class="muted">Pe≈Çny odczyt b≈Çƒôd√≥w, adaptacje, reset inspekcji. Orientacyjna cena: 80‚Äì180 PLN (zale≈ºnie od zakresu).</p>
        </article>

        <article style="margin-bottom:12px">
          <h4>Wymiana oleju i filtr√≥w</h4>
          <p class="muted">Wymiana oleju z filtrem + kontrola podstawowych uk≈Çad√≥w. Orientacyjna cena: 150‚Äì400 PLN.</p>
        </article>

        <article style="margin-bottom:12px">
          <h4>Naprawy zawieszenia</h4>
          <p class="muted">Wymiana wahaczy, ≈ÇƒÖcznik√≥w, amortyzator√≥w, regulacja geometrii. Cena wg wyceny.</p>
        </article>
      </div>

      <div>
        <article style="margin-bottom:12px">
          <h4>Serwis klimatyzacji</h4>
          <p class="muted">Kontrola, odgrzybianie i dope≈Çnienie czynnika. Orientacyjna cena: 120‚Äì350 PLN.</p>
        </article>

        <article style="margin-bottom:12px">
          <h4>Wulkanizacja / Felgi</h4>
          <p class="muted">Sezonowa wymiana, wywa≈ºanie, naprawa felg. Cena wg rozmiaru i zakresu.</p>
        </article>

        <article style="margin-bottom:12px">
          <h4>PrzeglƒÖdy okresowe</h4>
          <p class="muted">PrzeglƒÖdy serwisowe zgodnie z zaleceniami producenta. Raport z wykonanych prac.</p>
        </article>
      </div>
    </div>

  </section>

  <!-- O NAS (z animowanym t≈Çem przewijajƒÖcych siƒô aut) -->
  <section id="onas" class="section about-wrap" aria-labelledby="onasTitle">
    <div class="about-bg move" style="background-image:url('https://images.unsplash.com/photo-1542367597-7fa4d3d6b2fc?w=1400&q=60')"></div>
    <div style="position:relative;z-index:3">
      <h3 id="onasTitle">O nas</h3>
      <p class="muted">AVA to zesp√≥≈Ç mechanik√≥w z pasjƒÖ i do≈õwiadczeniem. Pracujemy z nowoczesnym sprzƒôtem diagnostycznym, inwestujemy w szkolenia i czƒô≈õci wysokiej jako≈õci. Dziƒôki temu naprawy sƒÖ rzetelne i trwa≈Çe.</p>

      <h4 style="margin-top:18px">Nasz zesp√≥≈Ç</h4>
      <ul>
        <li><strong>Miros≈Çaw</strong> ‚Äî W≈Ça≈õciciel zak≈Çadu.</li>
        <li><strong>Marek</strong> ‚Äî Pracownik.</li>
        <li><strong>Piotr</strong> ‚Äî Pracownik.</li>
      </ul>
    </div>
  </section>

  <!-- GALERIA -->
  <section id="galeria" class="section" aria-labelledby="galeriaTitle">
    <h3 id="galeriaTitle">Galeria naszych realizacji</h3>
    <div class="gallery">
  <img src="https://images.unsplash.com/photo-1611691540940-d05f3f3e14f3?w=900&q=80" alt="Samoch√≥d w warsztacie">
  <img src="https://images.unsplash.com/photo-1619404069572-bb3b9b62e47f?w=900&q=80" alt="Prace przy silniku">
  <img src="https://images.unsplash.com/photo-1590487983496-8ff16e7dc5c2?w=900&q=80" alt="Diagnostyka komputerowa">
  <img src="https://images.unsplash.com/photo-1549921296-3f3223d8b273?w=900&q=80" alt="Wulkanizacja">
  <img src="https://images.unsplash.com/photo-1503376780353-7e6692767b70?w=900&q=80" alt="Zesp√≥≈Ç mechanik√≥w">
  <!-- nowe sportowe auta -->
  <img src="https://images.unsplash.com/photo-1618335571254-3e2e5e70b1c7?w=900&q=80" alt="BMW M4">
  <img src="https://images.unsplash.com/photo-1600180758895-0a2ffb9876ea?w=900&q=80" alt="Porsche 911">
  <img src="https://images.unsplash.com/photo-1611764335916-0ad278f3c00d?w=900&q=80" alt="Audi R8">
</div>
    <p class="muted" style="margin-top:12px">Kliknij zdjƒôcie, by powiƒôkszyƒá (funkcja do dopisania) ‚Äî na szybko galeria s≈Çu≈ºy jako przeglƒÖd prac.</p>
  </section>

  <!-- OPINIE -->
  <section id="opinie" class="section" aria-labelledby="opinieTitle">
    <h3 id="opinieTitle">Opinie klient√≥w</h3>
    <p class="muted">Opinie zbieramy i wy≈õwietlamy ‚Äî realne oceny pomagajƒÖ zbudowaƒá zaufanie.</p>
    <div style="display:flex;gap:12px;align-items:center;margin-top:12px">
      <button id="loadOpinieBtn" class="btn white">Poka≈º opinie</button>
      <button id="openReviewForm" class="btn">Dodaj opiniƒô</button>
    </div>

    <div id="opinieWrapper" style="margin-top:16px;display:none">
      <div id="opinieList" class="opinie-list"></div>
      <div style="margin-top:8px;color:var(--muted)" id="sredniaOcena">≈örednia: ‚Äî</div>
    </div>

    <div id="reviewFormPanel" style="display:none;margin-top:18px">
      <form id="reviewForm" class="contact">
        <input name="name" type="text" placeholder="Twoje imiƒô" required />
        <select name="rating" required>
          <option value="">Wybierz ocenƒô</option>
          <option value="5">5 ‚Äî ≈õwietnie</option>
          <option value="4">4 ‚Äî dobrze</option>
          <option value="3">3 ‚Äî ≈õrednio</option>
          <option value="2">2 ‚Äî s≈Çabo</option>
          <option value="1">1 ‚Äî ≈∫le</option>
        </select>
        <textarea name="comment" placeholder="Opisz wizytƒô (opcjonalnie)"></textarea>
        <input name="email" type="email" placeholder="Tw√≥j e-mail (potrzebny do weryfikacji)" required />
        <div style="display:flex;gap:8px">
          <button type="submit" class="btn">Wy≈õlij opiniƒô</button>
          <button type="button" id="cancelReview" class="btn secondary">Anuluj</button>
        </div>
        <div id="reviewMsg" class="muted" style="margin-top:8px"></div>
      </form>
    </div>
  </section>

  <!-- KONTAKT & UM√ìW WIZYTƒò -->
  <section id="kontakt" class="section" aria-labelledby="kontaktTitle">
    <h3 id="kontaktTitle">Kontakt & Um√≥w wizytƒô</h3>
    <div class="two-col">
      <div>
        <p class="muted">Skontaktuj siƒô telefonicznie lub wype≈Çnij formularz ‚Äî odpisujemy i potwierdzamy termin.</p>
        <form id="contactForm" class="contact" aria-label="Formularz kontaktowy">
          <input name="name" placeholder="Imiƒô i nazwisko" required />
          <input name="phone" placeholder="Telefon" required />
          <input name="email" placeholder="E-mail" type="email" />
          <select name="service">
            <option value="">Wybierz us≈Çugƒô (opcjonalnie)</option>
            <option>Diagnostyka</option>
            <option>Wymiana oleju</option>
            <option>Zawieszenie</option>
            <option>Klimatyzacja</option>
          </select>
          <textarea name="notes" placeholder="Dodatkowe informacje"></textarea>
          <div style="display:flex;gap:8px">
            <button type="submit" class="btn">Wy≈õlij zg≈Çoszenie</button>
            <button type="button" id="clearContact" class="btn secondary">Wyczy≈õƒá</button>
          </div>
          <div id="contactMsg" style="margin-top:10px" class="muted"></div>
        </form>
      </div>

      <aside style="background:var(--panel);padding:16px;border-radius:12px">
        <strong>Adres</strong>
        <p class="muted" style="margin:8px 0">ul. Przyk≈Çadowa 1, 00-001 Miasto</p>
        <p class="muted">Tel: <a href="tel:+48601749485">+48 601 749 485</a></p>
        <p class="muted">E-mail: <a href="mailto:ava.autosklep@gmail.com">ava.autosklep@gmail.com</a></p>
        <div style="margin-top:10px"><a class="btn white" href="https://maps.google.com?q=warsztat+AVA" target="_blank">Otw√≥rz w mapach</a></div>
      </aside>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="section" aria-labelledby="faqTitle">
    <h3 id="faqTitle">FAQ ‚Äî najczƒô≈õciej zadawane pytania</h3>
    <details><summary>Jak um√≥wiƒá wizytƒô?</summary><p class="muted">Telefonicznie lub przez formularz kontaktowy ‚Äî potwierdzamy termin SMS-em.</p></details>
    <details><summary>Czy oferujecie samoch√≥d zastƒôpczy?</summary><p class="muted">Na chwilƒô obecnƒÖ nie mamy samochod√≥w zastƒôpczych.</p></details>
    <details><summary>Czy przyjmujecie na holowanie?</summary><p class="muted">Wsp√≥≈Çpracujemy z firmƒÖ assistance ‚Äî pomagamy w organizacji transportu auta.</p></details>
    <details><summary>Jakie marki serwisujecie?</summary><p class="muted">Serwisujemy wiƒôkszo≈õƒá marek osobowych i dostawczych ‚Äî wyjƒÖtek: auta czysto elektryczne bez um√≥w serwisowych.</p></details>
  </section>

</main>

<!-- back to home -->
<button id="backBtn" title="Powr√≥t do startu" aria-label="Powr√≥t">üè†</button>

<script>
/* ---------- Helpers & state ---------- */
const navBtns = document.querySelectorAll('nav.top-nav button');
const screens = {
  misja: document.getElementById('misja'),
  dlaczego: document.getElementById('dlaczego'),
  uslugi: document.getElementById('uslugi'),
  onas: document.getElementById('onas'),
  galeria: document.getElementById('galeria'),
  opinie: document.getElementById('opinie'),
  kontakt: document.getElementById('kontakt'),
  faq: document.getElementById('faq')
};
const startHero = document.querySelector('.hero');
const slides = document.querySelectorAll('.hero .slide');
let slideIndex = 0;

/* ---------- Slide show (hero) ---------- */
function nextSlide(){
  slides.forEach(s=>s.classList.remove('active'));
  slideIndex = (slideIndex+1) % slides.length;
  slides[slideIndex].classList.add('active');
}
setInterval(nextSlide, 6000);

/* ---------- scroll + sticky nav active highlight ---------- */
const headerHeight = document.querySelector('.site-header').offsetHeight;
const sectionOffsets = {};
function refreshOffsets(){
  for(const key in screens){
    const el = screens[key];
    if(el) sectionOffsets[key] = el.getBoundingClientRect().top + window.scrollY - headerHeight - 20;
  }
}
window.addEventListener('load', refreshOffsets);
window.addEventListener('resize', refreshOffsets);

window.addEventListener('scroll', ()=>{
  const y = window.scrollY;
  // highlight nav when near a section
  let activeKey = null;
  for(const key in sectionOffsets){
    if(y >= sectionOffsets[key] - 40) activeKey = key;
  }
  navBtns.forEach(b=>{
    if(b.dataset.target === activeKey) b.classList.add('active'); else b.classList.remove('active');
  });

  // sticky behavior: if user scrolls away from top show back button
  const backBtn = document.getElementById('backBtn');
  if(y > 60){ backBtn.style.display = 'flex'; } else { backBtn.style.display = 'none'; }
});

/* ---------- smooth scroll to section when clicking nav ---------- */
navBtns.forEach(btn=>{
  btn.addEventListener('click', (e)=>{
    const id = btn.dataset.target;
    const targetEl = document.getElementById(id);
    if(targetEl){
      const top = targetEl.getBoundingClientRect().top + window.scrollY - headerHeight - 10;
      window.scrollTo({top,behavior:'smooth'});
    }
  });
});
document.getElementById('homeBtn').addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));
document.getElementById('backBtn').addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));

/* ---------- about background animation starts when section visible ---------- */
const aboutBg = document.querySelector('.about-bg');
function checkAboutVisible(){
  const rect = document.getElementById('onas').getBoundingClientRect();
  if(rect.top < window.innerHeight && rect.bottom > 0){
    aboutBg.classList.add('move');
  } else {
    aboutBg.classList.remove('move');
  }
}
window.addEventListener('scroll', checkAboutVisible);
window.addEventListener('load', checkAboutVisible);

/* ---------- Opinie: load from SheetDB on demand ---------- */
const SHEETDB = 'https://sheetdb.io/api/v1/kr749eomw8d09';
document.getElementById('loadOpinieBtn').addEventListener('click', loadOpinie);
function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;'); }
async function loadOpinie(){
  const wrapper = document.getElementById('opinieWrapper');
  const list = document.getElementById('opinieList');
  const sred = document.getElementById('sredniaOcena');
  wrapper.style.display = 'block';
  list.innerHTML = '<div class="muted">≈Åadowanie opinii‚Ä¶</div>';
  try{
    const res = await fetch(SHEETDB);
    if(!res.ok) throw new Error('B≈ÇƒÖd sieci');
    const data = await res.json();
    if(!Array.isArray(data) || data.length === 0){ list.innerHTML = '<div class="muted">Brak opinii.</div>'; sred.textContent = '≈örednia: ‚Äî'; return; }
    list.innerHTML = '';
    let sum=0,count=0;
    data.slice().reverse().forEach(entry=>{
      const r = parseInt(entry.rating||0,10);
      const c = (entry.comment||'').trim();
      const n = (entry.name||'Anonim').trim();
      if(r>0){ sum+=r; count++; }
      const block = document.createElement('div'); block.className = 'opinia';
      block.innerHTML = `<div style="font-weight:700">${escapeHtml(n)} <span style="font-weight:400;color:var(--muted)">¬∑ ${'‚≠ê'.repeat(Math.max(0,Math.min(5,r)))}</span></div><div style="margin-top:6px">${c?escapeHtml(c):'<span class="muted">Bez komentarza</span>'}</div>`;
      list.appendChild(block);
    });
    sred.textContent = count?('≈örednia: ' + (sum/count).toFixed(1) + ' /5 ('+count+' ocen)') : '≈örednia: ‚Äî';
  }catch(err){
    list.innerHTML = '<div class="muted">Nie uda≈Ço siƒô za≈Çadowaƒá opinii.</div>';
    console.error(err);
  }
}

/* ---------- Review form (simple client-side validation + POST) ---------- */
const openReviewBtn = document.getElementById('openReviewForm');
openReviewBtn.addEventListener('click', ()=> document.getElementById('reviewFormPanel').style.display='block');

document.getElementById('cancelReview').addEventListener('click', ()=>{
  document.getElementById('reviewFormPanel').style.display='none';
  document.getElementById('reviewMsg').textContent='';
  document.getElementById('reviewForm').reset();
});

document.getElementById('reviewForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const f = e.target;
  const name = f.name.value.trim() || 'Anonim';
  const rating = f.rating.value;
  const comment = f.comment.value.trim();
  const email = f.email.value.trim();
  if(!rating || !email){ document.getElementById('reviewMsg').textContent='Wype≈Çnij wymagane pola.'; return; }
  // 24h block
  const last = localStorage.getItem('ostatniaOpinia');
  if(last && (Date.now() - parseInt(last,10)) < 24*60*60*1000){ document.getElementById('reviewMsg').textContent='Mo≈ºesz dodaƒá opiniƒô raz na 24h.'; return; }
  // payload for sheetdb
  const payload = { data: { name, rating, comment, email } };
  try{
    const res = await fetch(SHEETDB, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
    if(res.ok){ document.getElementById('reviewMsg').textContent='Dziƒôkujemy ‚Äî opinia przes≈Çana!'; localStorage.setItem('ostatniaOpinia', Date.now().toString()); f.reset(); loadOpinie(); }
    else { document.getElementById('reviewMsg').textContent='B≈ÇƒÖd przy zapisie opinii.'; console.error(await res.text()); }
  }catch(err){ document.getElementById('reviewMsg').textContent='B≈ÇƒÖd sieci ‚Äî spr√≥buj p√≥≈∫niej.'; console.error(err); }
});

/* ---------- Contact form (client stub) ---------- */
document.getElementById('contactForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  const f = e.target;
  document.getElementById('contactMsg').textContent = 'Dziƒôkujemy ‚Äî zg≈Çoszenie wys≈Çane. Skontaktujemy siƒô wkr√≥tce.';
  f.reset();
});

/* ---------- Accessibility improvements ---------- */
// allow nav buttons to be focused and activated with Enter
navBtns.forEach(b=>{
  b.addEventListener('keydown', (ev)=>{ if(ev.key === 'Enter') b.click(); });
});

/* ---------- init offsets for nav highlight ---------- */
setTimeout(()=>{ window.dispatchEvent(new Event('resize')); refreshOnLoad(); }, 200);
function refreshOnLoad(){ /* recalc offsets */ const evt = new Event('resize'); window.dispatchEvent(evt); }

/* ---------- small util: recalc offsets for highlight (keeping simple) ---------- */
function calcSectionPositions(){
  // not used heavy-duty here; highlight based on scroll loop above
}
// Powiƒôkszanie zdjƒôƒá galerii
const galleryImgs = document.querySelectorAll('.gallery img');
galleryImgs.forEach(img => {
  img.style.cursor = 'pointer';
  img.addEventListener('click', () => {
    // Stw√≥rz modal
    const modal = document.createElement('div');
    modal.style.position = 'fixed';
    modal.style.inset = '0';
    modal.style.background = 'rgba(0,0,0,0.9)';
    modal.style.display = 'flex';
    modal.style.alignItems = 'center';
    modal.style.justifyContent = 'center';
    modal.style.zIndex = 99999;
    modal.innerHTML = `<img src="${img.src}" style="max-width:90%;max-height:90%;border-radius:12px;">`;
    modal.addEventListener('click', ()=> modal.remove());
    document.body.appendChild(modal);
  });
});
</script>


</body>
</html>
